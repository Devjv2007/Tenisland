// Gerar cliente Prisma
generator client {
  provider = "prisma-client-js"
}

// Conex√£o com banco
datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// Modelos
model Brand {
  id          Int      @id @default(autoincrement())
  name        String
  description String?
  logo_url    String?
  website     String?
  created_at  DateTime @default(now())

  products Product[]

  @@map("brands")
}

model Category {
  id          Int      @id @default(autoincrement())
  name        String
  description String?
  image_url   String?
  created_at  DateTime @default(now())

  products Product[]

  @@map("categories")
}

model Product {
  id             Int      @id @default(autoincrement())
  name           String
  description    String?
  brand_id       Int
  category_id    Int
  price          Decimal  @db.Decimal(10, 2)
  stock_quantity Int
  size           String?
  color          String?
  image1         String?
  image2         String?
  image3         String?
  image4         String?
  image5         String?
  is_active      Boolean  @default(true)
  created_at     DateTime @default(now())

  brand      Brand       @relation(fields: [brand_id], references: [id])
  category   Category    @relation(fields: [category_id], references: [id])
  wishlists  Wishlist[]
  orderItems OrderItem[]

  @@map("products")
}

model User {
  id           Int       @id @default(autoincrement())
  firstName    String    @map("first_name")
  lastName     String?   @map("last_name")
  email        String    @unique
  passwordHash String    @map("password_hash")
  phone        String?
  birthDate    DateTime? @map("birth_date")
  isActive     Boolean   @default(true) @map("is_active")
  createdAt    DateTime  @default(now()) @map("created_at")
  updatedAt    DateTime  @updatedAt @map("updated_at")

  wishlists Wishlist[]
  orders    Order[]

  @@map("users")
}

model Wishlist {
  id         Int      @id @default(autoincrement())
  user_id    Int
  product_id Int
  created_at DateTime @default(now())

  user    User    @relation(fields: [user_id], references: [id], onDelete: Cascade)
  product Product @relation(fields: [product_id], references: [id], onDelete: Cascade)

  @@unique([user_id, product_id])
  @@map("wishlists")
}

model Order {
  id                 Int       @id @default(autoincrement())
  userId             Int?      @map("user_id")
  name               String?
  totalAmount        Float     @map("total_amount") 
  shippingAddressId  Int?      @map("shipping_address_id")
  orderDate          DateTime? @map("order_date") @db.Timestamptz
  shippedDate        DateTime? @map("shipped_date") @db.Timestamptz
  deliveredDate      DateTime? @map("delivered_date") @db.Timestamptz
  status             String?
  paymentStatus      String?   @map("payment_status")
  notes              String?
  paymentMethod      String?   @map("payment_method")

  user       User?       @relation(fields: [userId], references: [id])
  orderItems OrderItem[]

  @@map("orders")
}

model OrderItem {
  id        Int      @id @default(autoincrement())
  orderId   Int      @map("order_id")
  productId Int      @map("product_id")
  quantity  Int
  price     Float
  size      String?
  createdAt DateTime @default(now()) @map("created_at")

  order   Order   @relation(fields: [orderId], references: [id], onDelete: Cascade)
  product Product @relation(fields: [productId], references: [id])

  @@map("order_items")
}